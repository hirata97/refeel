# Issue #162: 気分理由入力フィールドの追加

## 概要
## Summary
気分スコア入力時に「その気分の理由」を記録できるフィールドを追加し、モチベーション変化の要因分析を可能にする。

## Root Cause Analysis (根本原因分析)
**なぜこの問題が発生したか:**
- [x] 設計段階での考慮不足
- [ ] 実装時のロジックミス
- [ ] テストケースの不備
- [ ] 外部依存関係の変更
- [x] 要件の理解不足
- [ ] 技術選定の問題
- [ ] その他: [具体的な原因を記述]

**具体的な原因:**
現在は気分スコア（1-10）のみの記録で、なぜその気分になったかの要因が記録されていない。これによりモチベーション変化の分析が困難。

**今後の予防策:**
- 定量データと定性データの組み合わせを考慮した設計
- ユーザーの自己分析を促す入力項目の検討

## 実装内容

### 機能仕様
- 気分スコア選択後に「理由」入力フィールドを表示
- プレースホルダー例：「仕事がうまくいった」「体調が悪い」「目標達成できた」等
- 任意入力（必須ではない）
- 50文字程度の短いコメント

### UI設計
```vue
<v-text-field
  v-if="mood"
  v-model="moodReason"
  label="その気分の理由は？（任意）"
  placeholder="例：目標達成できた、疲れている、良いことがあった"
  outlined
  clearable
  counter="50"
/>
```

### データベース変更
- `diaries`テーブルに`mood_reason`フィールド追加（varchar(100), nullable）
- 型定義更新（DiaryEntry型にmood_reasonプロパティ追加）

### 表示・分析機能
- DiaryViewPageで気分理由も表示
- 将来的に理由のキーワード分析機能の基盤とする

## Test plan
- [ ] 気分理由入力・保存の動作確認
- [ ] 理由なしでも正常に保存されることを確認
- [ ] 既存の気分スコア機能への影響確認
- [ ] 文字数制限の動作確認
- [ ] ユニットテスト：フォームバリデーション
- [ ] E2Eテスト：気分+理由の記録フロー

## 関連
**親チケット**: #160 - [親チケット] モチベーション測定機能強化

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

## ラベル
priority:P2,size:S,type-basic:enhancement

## 実装タスク
- [ ] Issue内容の詳細確認
- [ ] 必要なファイルの特定
- [ ] 実装方針の決定
- [ ] コード実装
- [ ] テスト実行
- [ ] 動作確認

## 実行コマンド例
```bash
# Issue作業開始
npm run start-issue 162

# 作業完了後PR作成  
npm run create-pr "fix: Issue #162 気分理由入力フィールドの追加" "Issue #162の対応

Closes #162"
```

## Claude Code用プロンプト
```
Issue #162の対応をお願いします。

タイトル: 気分理由入力フィールドの追加
ラベル: priority:P2,size:S,type-basic:enhancement

内容:
## Summary
気分スコア入力時に「その気分の理由」を記録できるフィールドを追加し、モチベーション変化の要因分析を可能にする。

## Root Cause Analysis (根本原因分析)
**なぜこの問題が発生したか:**
- [x] 設計段階での考慮不足
- [ ] 実装時のロジックミス
- [ ] テストケースの不備
- [ ] 外部依存関係の変更
- [x] 要件の理解不足
- [ ] 技術選定の問題
- [ ] その他: [具体的な原因を記述]

**具体的な原因:**
現在は気分スコア（1-10）のみの記録で、なぜその気分になったかの要因が記録されていない。これによりモチベーション変化の分析が困難。

**今後の予防策:**
- 定量データと定性データの組み合わせを考慮した設計
- ユーザーの自己分析を促す入力項目の検討

## 実装内容

### 機能仕様
- 気分スコア選択後に「理由」入力フィールドを表示
- プレースホルダー例：「仕事がうまくいった」「体調が悪い」「目標達成できた」等
- 任意入力（必須ではない）
- 50文字程度の短いコメント

### UI設計
```vue
<v-text-field
  v-if="mood"
  v-model="moodReason"
  label="その気分の理由は？（任意）"
  placeholder="例：目標達成できた、疲れている、良いことがあった"
  outlined
  clearable
  counter="50"
/>
```

### データベース変更
- `diaries`テーブルに`mood_reason`フィールド追加（varchar(100), nullable）
- 型定義更新（DiaryEntry型にmood_reasonプロパティ追加）

### 表示・分析機能
- DiaryViewPageで気分理由も表示
- 将来的に理由のキーワード分析機能の基盤とする

## Test plan
- [ ] 気分理由入力・保存の動作確認
- [ ] 理由なしでも正常に保存されることを確認
- [ ] 既存の気分スコア機能への影響確認
- [ ] 文字数制限の動作確認
- [ ] ユニットテスト：フォームバリデーション
- [ ] E2Eテスト：気分+理由の記録フロー

## 関連
**親チケット**: #160 - [親チケット] モチベーション測定機能強化

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

---
Generated: 2025-08-26 12:58:08
Source: https://github.com/RsPYP/GoalCategorizationDiary/issues/162
